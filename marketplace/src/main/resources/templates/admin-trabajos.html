<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">

<head>
    <title>Administrar Trabajos</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #f4f6f8;
            margin: 20px;
            padding: 20px;
            color: #333;
        }

        h1 {
            text-align: center;
            color: #2c3e50;
            margin-bottom: 30px;
        }

        form.filtro-form {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 12px;
            background-color: #ffffff;
            padding: 15px 25px;
            border-radius: 10px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            max-width: 500px;
            margin: 0 auto 25px auto;
        }

        form.filtro-form label {
            font-weight: bold;
            font-size: 16px;
            color: #2c3e50;
        }

        form.filtro-form select {
            padding: 8px 12px;
            border-radius: 6px;
            border: 1px solid #ccc;
            font-size: 14px;
            background-color: #fdfdfd;
        }

        form.filtro-form button {
            padding: 8px 16px;
            background-color: #3498db;
            color: white;
            font-weight: bold;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            transition: background-color 0.3s ease;
        }

        form.filtro-form button:hover {
            background-color: #2980b9;
        }

        select,
        button {
            padding: 8px 12px;
            margin-left: 10px;
            font-size: 14px;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            background-color: white;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        th,
        td {
            padding: 12px 15px;
            border: 1px solid #ddd;
            text-align: center;
        }

        th {
            background-color: #2c3e50;
            color: white;
        }

        tr:nth-child(even) {
            background-color: #f9f9f9;
        }

        tr:hover {
            background-color: #f1f1f1;
        }

        a {
            color: #3498db;
            text-decoration: none;
            font-weight: bold;
        }

        a:hover {
            text-decoration: underline;
        }

        img {
            border-radius: 8px;
        }

        .aprobado {
            color: #27ae60;
            /* verde */
            font-weight: bold;
        }

        .desaprobado {
            color: #e74c3c;
            /* rojo */
            font-weight: bold;
        }

        .paginacion {
            margin-top: 20px;
            text-align: center;
        }

        .paginacion a {
            display: inline-block;
            padding: 8px 12px;
            margin: 0 4px;
            background-color: #ecf0f1;
            color: #2c3e50;
            text-decoration: none;
            border-radius: 6px;
            font-weight: bold;
        }

        .paginacion a:hover {
            background-color: #bdc3c7;
        }

        .pagina-activa {
            background-color: #3498db !important;
            color: white !important;
        }
    </style>
</head>

<body>
    <h1>Lista de Trabajos</h1>

    <!-- Formulario de filtro -->
    <form method="get" th:action="@{/admin/trabajos}" class="filtro-form">
        <label for="filtro">Filtrar por estado:</label>
        <select name="aprobado" id="filtro">
            <option value="">Todos</option>
            <option value="true" th:selected="${aprobado == 'true'}">Aprobados</option>
            <option value="false" th:selected="${aprobado == 'false'}">No Aprobados</option>
        </select>
        <button type="submit">Filtrar</button>
    </form>
    <p th:text="'Mostrando ' + ${trabajos.size()} + ' trabajos filtrados.'"></p>


    <!-- Tabla de trabajos -->
    <table>
        <thead>
            <tr>
                <th>ID</th>
                <th>Título</th>
                <th>Descripción</th>
                <th>Imagen</th>
                <th>Precio</th>
                <th>Contacto</th>
                <th>Aprobado</th>
                <th>Acciones</th>
            </tr>
        </thead>
        <tbody>
            <tr th:each="trabajo : ${trabajos}">
                <td th:text="${trabajo.id}"></td>
                <td th:text="${trabajo.titulo}"></td>
                <td th:text="${trabajo.descripcion}"></td>
                <td><img th:src="${trabajo.imagenUrl}" alt="Imagen" width="100" /></td>
                <td th:text="${trabajo.precio}"></td>
                <td th:text="${trabajo.numeroContacto}"></td>
                <td th:text="${trabajo.aprobado ? 'Sí' : 'No'}"
                    th:classappend="${trabajo.aprobado} ? 'aprobado' : 'desaprobado'"></td>
                <td>
                    <a th:href="@{/admin/trabajos/editar/{id}(id=${trabajo.id})}">Editar</a> |
                    <!-- Eliminar -->
                    <a th:href="@{/admin/trabajos/eliminar/{id}(id=${trabajo.id})}"
                        onclick="return confirmarEliminacion();">Eliminar</a> |

                    <!-- Aprobar -->
                    <span th:if="${!trabajo.aprobado}">
                        <a th:href="@{/admin/trabajos/aprobar/{id}(id=${trabajo.id})}"
                            onclick="return confirmarAprobacion();">Aprobar</a>
                    </span>

                    <!-- Desaprobar -->
                    <span th:if="${trabajo.aprobado}">
                        <a th:href="@{/admin/trabajos/desaprobar/{id}(id=${trabajo.id})}"
                            onclick="return confirmarDesaprobacion();">Desaprobar</a>
                    </span>

                </td>
            </tr>
        </tbody>

    </table>
    <div class="paginacion" th:if="${totalPages > 1}">
        <a th:if="${currentPage > 0}"
            th:href="@{/admin/trabajos(page=${currentPage - 1}, aprobado=${aprobado})}">Anterior</a>

        <span th:each="i : ${#numbers.sequence(0, totalPages - 1)}">
            <a th:href="@{/admin/trabajos(page=${i}, aprobado=${aprobado})}" th:text="${i + 1}"
                th:classappend="${i == currentPage} ? 'pagina-activa' : ''"></a>
        </span>

        <a th:if="${currentPage < totalPages - 1}"
            th:href="@{/admin/trabajos(page=${currentPage + 1}, aprobado=${aprobado})}">Siguiente</a>
    </div>

</body>
<script>
    function confirmarEliminacion() {
        return confirm("¿Seguro que quieres eliminar este trabajo?");
    }

    function confirmarAprobacion() {
        return confirm("¿Estás seguro de que quieres aprobar este trabajo?");
    }

    function confirmarDesaprobacion() {
        return confirm("¿Estás seguro de que quieres desaprobar este trabajo?");
    }
</script>

</html>